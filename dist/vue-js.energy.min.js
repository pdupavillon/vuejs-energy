"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();!function(){var t={dpe:[{color:"#309535",letter:"A",legend:"<= 50",isValid:function(t){return t<=50}},{color:"#51a835",letter:"B",legend:"51 à 90",isValid:function(t){return t>=51&&t<=90}},{color:"#c2ce00",letter:"C",legend:"91 à 150",isValid:function(t){return t>=91&&t<=150}},{color:"#eade00",letter:"D",legend:"151 à 230",isValid:function(t){return t>=151&&t<=230}},{color:"#f9c802",letter:"E",legend:"231 à 330",isValid:function(t){return t>=231&&t<=330}},{color:"#f09538",letter:"F",legend:"331 à 450",isValid:function(t){return t>=331&&t<=450}},{color:"#e0251e",letter:"G",text_color:"#fff",legend:"> 450",isValid:function(t){return t>450}}],ges:[{color:"#f6eefd",letter:"A",legend:"<= 5",isValid:function(t){return t<=5}},{color:"#e0c2f8",letter:"B",legend:"6 à 10",isValid:function(t){return t>=6&&t<=10}},{color:"#d4aaf6",letter:"C",legend:"11 à 20",isValid:function(t){return t>=11&&t<=20}},{color:"#cb95f3",letter:"D",legend:"21 à 35",isValid:function(t){return t>=21&&t<=35}},{color:"#ba72ef",letter:"E",legend:"36 à 55",isValid:function(t){return t>=36&&t<=55}},{color:"#a74deb",letter:"F",legend:"56 à 80",isValid:function(t){return t>=56&&t<=80}},{color:"#8919df",text_color:"#fff",letter:"G",legend:"> 80",isValid:function(t){return t>80}}]};Vue.component("energy",{props:["value","preset","settings"],data:function(){return{rating:null}},watch:{value:function(t){this.rating.select(t)}},mounted:function(){var e=null;if(this.preset&&Object.keys(t).indexOf(this.preset)!==-1)e=t[this.preset];else{if(!this.settings)throw new Error("missing settings");e=this.settings}this.rating=new EnergyRating(this.$el,e),this.rating.draw(),this.value&&this.rating.select(this.value)},template:"<svg></svg>"})}();var EnergyRating=function(){function t(e,i){_classCallCheck(this,t),this.svg=e,this.settings=i,"svg"!==e.tagName.toLowerCase()&&(this.svg=this._createSvgNode("svg",e),e.appendChild(this.svg)),this._init()}return _createClass(t,[{key:"_init",value:function(){this.dim=this.svg.getBoundingClientRect(),this.position=1,this.space=.1,this.length=this.dim.width/9,this.height=this.dim.height/this.settings.length,this.height=this.height-this.height*this.space}},{key:"_createSvgNode",value:function(t,e,i){var n=document.createElementNS("http://www.w3.org/2000/svg",t);for(var s in i){var r=i[s];void 0===r||s.match(/\$/)||"string"==typeof r&&""===r||n.setAttribute(s,r)}return n}},{key:"_drawSelect",value:function(t){return[this._drawPath({fill:"#000","stroke-width":"1",d:"m"+t.maxlen+","+t.position+"l-"+this.length+",0l-"+t.height/2+","+t.height/2+"l"+t.height/2+","+t.height/2+"l"+t.maxlen+",0z"}),this._drawPath({stroke:"#000","stroke-width":"1","stroke-dasharray":"2,2",d:"m"+(t.maxlen-this.length-t.height/2)+","+(t.position+t.height/2)+"l-"+(t.maxlen-this.length-t.height/2*2-t.len)+",0z"}),this._drawText({fill:"#fff","font-size":t.height/2,x:t.maxlen-this.length+this.length/6,y:t.position+t.height/2+t.height/6},t.text)]}},{key:"_drawText",value:function(t,e){var i={"stroke-width":"0","stroke-linejoin":"null","stroke-linecap":"null","font-family":"Arial"};t=Object.assign(i,t);var n=this._createSvgNode("text",this.svg,t);return n.innerHTML=e,this.svg.appendChild(n),n}},{key:"_drawLetter",value:function(t,e){var i={"font-weight":"bold"};return t=Object.assign(i,t),this._drawText(t,e)}},{key:"_drawLegend",value:function(t,e){var i={x:4};return t=Object.assign(i,t),this._drawText(t,e)}},{key:"_drawPath",value:function(t){var e={"stroke-width":"0","stroke-linejoin":"null","stroke-linecap":"null"};t=Object.assign(e,t);var i=this._createSvgNode("path",this.svg,t);return this.svg.appendChild(i),i}},{key:"_drawLine",value:function(t){return[this._drawPath({fill:t.setting.color,d:"m1,"+t.position+"l"+t.len+",0l"+t.height/2+","+t.height/2+"l-"+t.height/2+","+t.height/2+"l-"+t.len+",0z"}),this._drawLetter({fill:t.setting.text_color||"#000","font-size":t.height/2,x:t.len-t.height/5,y:t.position+t.height/2+t.height/6},t.setting.letter),this._drawLegend({fill:t.setting.text_color||"#000","font-size":t.height/2.5,y:t.position+t.height/2+t.height/6},t.setting.legend)]}},{key:"select",value:function(t){var e,i;if(this.selectedNodes&&this.selectedNodes.forEach(function(t){return t.remove()}),void 0!==t&&"number"==typeof t){var n=this.settings.filter(function(e){return e.isValid(t)});n&&1===n.length&&(e=this.settings.indexOf(n[0]),i=t)}else if(void 0!==t&&"string"==typeof t){var s=this.settings.filter(function(e){return e.letter.toLowerCase()===t.toLowerCase()});s&&1===s.length&&(e=this.settings.indexOf(s[0]),i=s[0].letter)}if(void 0!==e){var r={setting:this.settings[e],position:this.position+(this.height+this.height*this.space)*e,height:this.height,len:this.length*(e+1),maxlen:this.dim.width,text:i};this.selectedNodes=this._drawSelect(r)}}},{key:"draw",value:function(){var t=this;this.settings.forEach(function(e,i){var n={setting:e,position:t.position+(t.height+t.height*t.space)*i,height:t.height,len:t.length*(i+1)};t._drawLine(n)})}}]),t}();